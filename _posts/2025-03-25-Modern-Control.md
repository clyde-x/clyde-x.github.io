---
layout: article
title: "现代控制"
tags: "考研复试"
category: kaoyan
excerpt_separator: <!--brief-->
permalink: /kaoyan/moderncontrol
image:
  teaser: teaser1.jpg
---
现代控制，大三的时候程林上的，老师很好，我很笨（）上课的时候还顺带着复习了很多高数线代的东西，现在考研又学了一遍线代之后，对线代和现控都有了新的理解。
<!--brief-->
# 经典控制概述

核心：信号，系统对信号的处理作用

通过测量反馈-重塑系统-实现理想的信号处理

**信号**：基函数+坐标。常见的分解：时域（线性定常，微分方程计算困难）；傅里叶级数/变换（信号绝对可积）；拉普拉斯变换；泰勒展开

# 状态空间表达式

**状态**：动力学系统的状态可以定义为信息的集合。

**状态变量**：系统的状态变量是指能够完全表征系统运动状态的最小一组变量。完全表征是指：当$t>t_0$后的输入给定，系统的后续状态可以由当前时刻状态变量唯一确定 。最小性体现在：状态变量是为了表征系统行为所必须的最少个数的系统状态变量，减少变量个数将破坏表征的完整性，增加变量将是不需要的。状态变量的选取不是唯一的(状态变量的坐标转换)

**状态向量**：如果完全描述一个给定系统的动态行为需要个状态变量，那么状态向量定义为$\mathbf x(t)=[x_1(t),x_2(t)\cdots]^T$

**状态空间**：由状态向量张成的n维向量空间。力学系统的自由度和状态空间的维度是不同的

**状态方程**：将描述状态和输入决定的状态变化一阶微分方程定义为状态方程。

**状态空间表达式**：状态方程和输出方程组合起来，构成系统动态行为的完整描述，称之为系统的状态空间表达式。
**状态空间分析法**：以状态空间表达式为主要分析对象的方法，称之为状态空间分析法。

## 一般形式

**线性定常系统**
$$
\dot x=Ax+Bu\\ y=Cx+Du
$$
ABCD分别是系统矩阵、控制矩阵、输出矩阵、直接传递矩阵。惯性系统D=0

当各个矩阵都是与时间无关的常数，系统就是线性定常系统

**非线性系统**：$\dot x =f(x,u,t),y=g(x,u,t)$，分别为状态方程函数，输出方程函数，至少一个为状态变量和控制输入的非线性函数

单输入单输出SISO：$x\in\mathbb R^n,u\in \mathbb R,y\in\mathbb R$

多输入多输出MIMI：$x\in\mathbb R^n,u\in \mathbb R^p,y\in\mathbb R^m$

**离散系统**：

## 状态空间表达式的建立

由物理系统直接建立：分析物理机理，确定输入输出，建立微分方程

由传递函数建立：传递函数描述系统的输入输出关系，状态变量选取不唯一，可以直接/串联/并联分解

直接分解：写成能控标准型

串联分解：写成典型环节的串联，每个环节都是一个变量

并联分解：把传递函数因式分解，最后得到约当标准型

##  坐标转换

状态变量选取不唯一，不同状态下状态空间表达式可由可逆矩阵连接，物理意义是用不同的变量描述同一个问题，找到更便于特性分析的描述

 对于状态方程：$\dot x=Ax+Bu, y=Cx+Du$有可逆的转化矩P，实现坐标转换$x=P\bar x,\bar A=P^{-1}AP,\bar B=P^{-1}B,\bar C=CP,\bar D=D$，得到变换后的
$$
\dot{\bar x}=P^{-1}AP\bar x+P^{-1}Bu\\
y=CP\bar x+Du
$$

## 由状态空间表达式到传递函数

对状态空间表达式拉式变化，初值为0，得到传递函数矩阵，$G(s)=C(sI-A)^{-1}B+D$

状态的可逆变化不影响传递函数

## 线性定常系统状态方程的解

由初始状态引起的自由运动$\dot x=Ax$，确定唯一解$x(t)=e^{A(t-t_0)}x_0$。用状态转移矩阵$\Phi(t-t_0)=e^{A(t-t_0)}$

性质：$\Phi(0)=I,\Phi(-t)=\Phi^{-1}(t),\Phi(t_2-t_0)=\Phi(t_2-t_1)\Phi(t_1-t_0)，$

计算：$\Phi(t)=e^{At}=I+At+\frac12A^2t^2+\cdots\frac1{k!}A^kt^k$

特征分解求高次幂

A是对角阵时，直接把对角线上元素取指数

A是约当标准型，（这仅是一个约当块）
$$
A=J=\begin{bmatrix}\lambda &1&&&&\\&\lambda&1&\\&&\lambda&\ddots\\&&&\lambda&1\\&&&&\lambda\end{bmatrix},
\Phi(t)=e^{At}=e^{\lambda t}\begin{bmatrix}1&t&\frac1{2!}t^2&\cdots&\frac1{(n-1)!}t^{n-1}\\0&1&t&\cdots&\frac1{(n-2)!}t^{n-2}\\\vdots&\vdots&\vdots&\ddots&\vdots\\0&0&0&\cdots&t\\0&0&0&\cdots&1\end{bmatrix}
$$
也可以先求传递函数矩阵，进行拉普拉斯反变换，得到输入输出的时域关系

非齐次，也就是在u的作用下的强制运动而不是自由运动

# 可控性

对于任意时刻，若在有限的时间内，存在控制向量，能将**任意的**初始状态转移到另一**任意**状态，则系统可控。（或者由任意状态转移到0状态）与输出没关系

不可控：至少有一个状态变量不可控时，系统不可控

## 判据

**标准秩判据**：对于线性定常系统$\dot x = Ax+Bu$完全可控的**充要条件**是：$rank(S)=rank[B,AB,A^2B\cdots A^{n-1}B]=n$

**PBH判据**：充要条件，$rank[\lambda_iI-A,B]=n$

**Gram矩阵判据**：$W(0,t_1)=\int_0^{t_1}e^{-At}BB^Te^{-A^Tt}\mathrm dt$满秩，可计算实现状态转移的控制输入$u(\tau)=B^Te^{-A^Tt}W^{-1}(0,t_1)(e^{-At}x_1-x_0)$

## 特殊的可控性判据

**约当标准型**：矩阵可以化为约当标准型$J=T^{-1}AT$

每个约当块的特征值不同，每个约当块的最后一行对应的$\bar B$的元素不为全0

**可控标准型**：系统有可控标准型，则一定可控。
$$
A = \begin{bmatrix}0&1&0&\cdots &0\\0&0&1&\cdots &0\\\vdots&\vdots&\vdots&\ddots&\vdots\\0&0&0&\cdots &1\\-a_0&-a_1&-a_2&\cdots&-a_{n-1}\end{bmatrix},b=\begin{bmatrix}0\\0\\\vdots\\0\\1\end{bmatrix}
$$
可以通过可逆线性变化将完全可控的系统写为可控标准型，步骤：

1 通过标准秩判据判断系统可控性 2 将矩阵S取逆并按行分块，取最后一行记为$S_n^T$ 3 构造坐标转换矩阵$P^{-1}=[S_n^T,S_n^TA\cdots S_n^TA^{n-1}]$ 4 可逆线性变换$A_c=P^{-1}AP,B_c=P^{-1}B$

也可以进行拉普拉斯变换，再写为能控标准型

## 可控性分解

单输入单输出的可控性分解：若$rank(S)=n_1<n$，存在坐标转换矩阵$x=P\bar x$使得
$$
\dot{\bar x}=\begin{bmatrix}\dot{\bar x_1}\\\dot{\bar x_2}\end{bmatrix}=\begin{bmatrix}A_1&A_2\\0&A_4\end{bmatrix}\begin{bmatrix}\bar x_1\\\bar x_2\end{bmatrix}+\begin{bmatrix}b_1\\0\end{bmatrix}u\\
y=[C_1\quad C_2]\bar x+du
$$
其中$x_1$对应的变量是可控的，$rank(S_1)=rank[b_1,A_1b_1\cdots A_1^{n-1}b_1]=n_1$满秩

传递函数有关系：$C(sI-A)^{-1}b=C_1(sI-A_1)^{-1}b_1$，零极点对消。推论：不存在零极点对消的传递函数转状态空间表达式一定可控。

分解：坐标转换矩阵$P=[p_1,p_2\cdots p_{n_1-1},q_1\cdots q_{n-n_1}]$，前面$p_i$为能控矩阵S的$n_1$个线性无关的列，后面$q_i$为确保P非奇异的任意列向量。

# 可观性

希望通过观测值来推测状态真值，在有限时间内，根据输出值和输入值，能够唯一确定系统的初始状态，则系统是完全可观的。

## 判据

**标准秩判据**：完全可控的充要条件：$rank(V)=rank[C,CA,\cdots CA^{n-1}]^T=n$

## 对偶

两个系统，互为对偶系统，可控性相关定理和结论可以用于可观性分析。

$S_1可控\Leftrightarrow S_2可观,S_1可观\Leftrightarrow S_2可控$
$$
S_1:\begin{cases}\dot x=Ax+Bu\\y=Cx+Du\end{cases}\quad S_2:\begin{cases}\dot z=A^Tz+C^Tu\\\gamma=B^Tz+Du\end{cases}
$$

# 状态反馈和状态观测

核心任务：构造观测器，实现输出对状态的观测；构造控制器，实现任务需求的指令生成

状态反馈：$u=-Kx+r$，状态反馈增益矩阵$K\in\mathbb R^{m\times n}$

得到闭环系统动态方程：
$$
\dot x=Ax+B(-Kx+r)=(A-BK)x+Br\\
y=Cx
$$
状态反馈不影响系统可控性，状态反馈可能影响系统的可观性（可观变不可观，不可观变可观）

## 极点配置

添加状态反馈之后，得到传递函数的特征方程$det(sI-(A-bk))$，闭环矩阵的特征值也是系统极点

极点的作用：闭环系统的品质主要是由闭环的极点决定的，稳定性完全由闭环极点决定

极点配置：通过选取反馈增益阵K来改变闭环极点（特征值）在复平面的位置

SISO线性定常系统，闭环矩阵(A-bk)的特征值可以在复平面上任意配置的**充要条件**是系统(A,b)完全可控

对于给定的理想配置，系统不可控时，不一定能实现，也不一定不能实现

算法步骤：

1 计算可控性矩阵，分析极点配置的任意性（前提） 
2 计算系统矩阵A的特征多项式$det(sI-A)=s^n+a_{n-1}s^{n-1}+\cdots+a_1s+a_0$
3 根据要求的极点分布，计算期望的多项式$\Pi(s-\lambda_i)=s^n+b_{n-1}s^{n-1}+\cdots+b_1s+b_0$
4 计算状态反馈增益矩阵$\bar k=[b_0-a_0,b_1-a_1\cdots b_{n-1}-a_{n-1}]$
5 求原系统转为可控标准型的变换矩阵P
6 求原系统的状态反馈增益矩阵 $k=\bar kP^{-1}$

算法二，待定系数，假设$k=[k_1,k_2\cdots]$

极点配置后的闭环系统矩阵$det[sI-(A-bk)]$为含有参数$k_i$的关于s的多项式
上述多项式与理想的期望的多项式对比系数，求解k

## 输出反馈

状态反馈的特殊情况，在工程中往往只能测量输出，不可以直接测量状态。引自系统输出量的反馈为输出反馈$u=-Hy+r,\dot x=(A-BHCx)+Br$

输出反馈不影响可控性可观性

## 状态观测

实际工程中只能测量输出，状态不可以直接测量。如何通过观测值y来推测x，是状态反馈的前提

**Luenberger闭环观测器**（数字模拟）：$\dot{\hat x}=A\hat x+Bu+H(y-\hat y),\hat y=C\hat x$

观测误差$\Delta x=x-\hat x,\Delta\dot x=(A-HC)\Delta x, \Delta y=y-\hat y=C\Delta x$

通过配置H实现状态观测矩阵(A-HC)的特征值配置，让$\Delta x$收敛为0

若系统(A,c)可观，则状态观测矩阵的特征值可以任意配置

**卡尔曼滤波器**可以弥补Luenberger观测器在未考虑模型和观测误差的不足

## 闭环控制系统

<img src="{{site.url}}/images/kaoyanfushi/close_loop_control.png" alt="concavity" style="zoom:70%;" />

状态观测：由输出获取状态$\dot{\hat x}=A\hat x+Bu+H(y-\hat y),\hat y=C\hat x$

状态反馈：根据状态反馈配置极点$u=-Kx+r,\dot x=(A-BK)x+Br,y=Cx$

系统由n维变成2n维
$$
\begin{bmatrix}\dot x\\\dot{\hat x}\end{bmatrix}=\begin{bmatrix}A&-bK\\Hc&A-Hc-bK\end{bmatrix}\begin{bmatrix}x\\{\hat x}\end{bmatrix}+\begin{bmatrix}b\\b\end{bmatrix}r
,y=\begin{bmatrix}c&0\end{bmatrix}\begin{bmatrix}x\\{\hat x}\end{bmatrix}
$$
**分离定理**：系统的传递函数依旧是$G(s)=c[sI_n-(A-bk)]^{-1}b$

特征多项式：$det[sI_n-((A-bk))]det[sI_n-(a-Hc)]$

结论：用状态的估计值进行反馈，不影响输入输出关系。若系统可观可控，状态反馈和观测可以分开设计

# 稳定性理论

稳定性：受到扰动回复理想状态的能力

线性定常系统的稳定性：所有极点在左半平面。只取决于系统的结构和参数，与初始条件和外界扰动无关

讨论非线性时变系统$\dot x=f(x,u,t)$的稳定性。在给定控制下$\dot x=f(x,t)$

**平衡状态**：对于任意时间t，$\dot x_e=f(x_e,t)\equiv 0$

**超球域**：用$s(\varepsilon)$表示以平衡点$x_e$为中心的超球体，可以说某个状态在超球域内，或者状态轨迹$x(t)=\Phi(t;x_0,t_0)$在超球域内

## 李雅普诺夫稳定性

四种：

- 稳定：当$x_0\in s(\delta)$时，从任意初始状态出发的解都满足$\Phi(t;x_0,t_0)\in s(\varepsilon)$。即当初值在一定范围内，终值也会在一定范围内

- 渐进稳定：系统在平衡点稳定，当时间无线增长时，状态轨迹不仅不会超过$s(\varepsilon)$，最终还会收敛到平衡状态，称为渐进稳定。

- 大范围渐进稳定：系统在平衡点稳定，从任意初始状态出发的轨迹都渐进稳定。必要条件：整个状态空间中只有一个平衡状态；线性系统渐近稳定则必大范围渐近稳定
- 不稳定：系统在平衡点稳定，但不管$\delta$多小，从$s(\delta)$出发的状态轨迹，至少有一个会越过$s(\varepsilon)$，则系统不稳定

总结：$s(\delta)$限制了初始状态的取值范围，$s(\varepsilon)$限制了状态轨迹线的边界。稳定：状态轨迹线有界；渐近稳定：状态轨迹线有极限；不稳定：无界

在工程控制中，**只有渐近稳定才是稳定**。李雅普诺夫意义下的稳定，则是**临界稳定**

**只有平衡点才有资格谈论稳定性**

## 判据-第一法

通过特征根来判别系统稳定性

线性系统的两类判据：

**状态稳定性**又称内部稳定性，研究对象$\dot x=Ax$，稳定性的分析对象是**状态**$x$

判据：渐近稳定的充要条件是A的所有特征值都有负实部

**输出稳定性**又称BIBO稳定性，研究对象$\dot x=Ax+bu,y=cx$，稳定性分析对象是**输出**$y$

频域判据：G(s)的极点都有负实部

时域判据：系统脉冲响应积分有界

状态稳定是BIBO稳定的充分条件。如果系统不存在零极点对消，则二者等价

**非线性**：找平衡点，在平衡点对状态矢量泰勒展开，再判断

## 判据-第二法

从能量的观点直接分析平衡状态的稳定性

定义一个正定的标量函数$V(x)$，作为虚构的广义能量函数，再通过$\dot V(x)$的符号特征判断系统稳定性。

在$x\neq0$处，若导数**半负定**，则稳定；**负定**，则渐近稳定/大范围渐近稳定；**正定**，不稳定

对线性定常系统大范围渐近稳定的充要条件：对任意给定的正定对称矩阵Q，都存在唯一正定的对称矩阵P，使得$A^TP+PA=-Q$

线性时变系统：对任意给定的连续对称正定矩阵$Q(t)$，存在唯一 的连续正定对称矩阵$P(t)$，使得$\dot P(t)=-A(t)^TP(t)-P(t)A(t)-Q(t)$，此时李雅普诺夫函数取$V(x,t)=x^T(t)P(t)x(t)$

# 非线性

常见非线性，不满足叠加定理

死区，饱和，间隙，继电

分析方法：小扰动线性化（李雅普诺夫第一法）；李雅普诺夫第二法；相平面、描述函数法等；数字仿真

